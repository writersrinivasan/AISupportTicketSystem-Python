{% extends "base.html" %}

{% block content %}
<div class="card">
    <h2 style="margin-bottom: 20px; color: #2d3748;">üèóÔ∏è System Architecture</h2>
    <p style="color: #666; margin-bottom: 25px;">
        Technical overview of the token-efficient AI support ticket system design and implementation.
    </p>
    
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px; margin-bottom: 30px;">
        <div class="arch-card">
            <h3>üìä Data Schema</h3>
            <div class="code-block">
{
  "id": "T001",         // 4 chars max
  "title": "string",    // 50 chars max
  "desc": "string",     // 200 chars max
  "cat": "code",        // code|infra|doc|other
  "pri": 2,             // 1=high, 2=med, 3=low
  "stat": "open",       // open|prog|done
  "created": "2024-01-15",
  "res": "string"       // 100 chars max
}
            </div>
        </div>
        
        <div class="arch-card">
            <h3>ü§ñ AI Processing Flow</h3>
            <div style="color: #666; font-size: 0.95rem; line-height: 1.6;">
                <div style="margin-bottom: 10px;">1. <strong>Parse Input:</strong> Extract action and parameters</div>
                <div style="margin-bottom: 10px;">2. <strong>Auto-Classify:</strong> Detect category and priority</div>
                <div style="margin-bottom: 10px;">3. <strong>Validate:</strong> Check required fields</div>
                <div style="margin-bottom: 10px;">4. <strong>Process:</strong> Execute ticket operation</div>
                <div>5. <strong>Respond:</strong> Return compressed JSON</div>
            </div>
        </div>
        
        <div class="arch-card">
            <h3>‚ö° Token Optimizations</h3>
            <div style="color: #666; font-size: 0.95rem; line-height: 1.6;">
                <div style="margin-bottom: 10px;">‚Ä¢ <strong>Abbreviated fields:</strong> cat vs category</div>
                <div style="margin-bottom: 10px;">‚Ä¢ <strong>Enum values:</strong> prog vs in_progress</div>
                <div style="margin-bottom: 10px;">‚Ä¢ <strong>Template responses:</strong> Pre-computed JSON</div>
                <div style="margin-bottom: 10px;">‚Ä¢ <strong>Smart defaults:</strong> Reduce parameters</div>
                <div>‚Ä¢ <strong>Batch operations:</strong> Multiple updates</div>
            </div>
        </div>
    </div>
</div>

{% if token_analysis %}
<div class="card">
    <h2 style="margin-bottom: 20px; color: #2d3748;">üìà Live Token Analysis</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 25px;">
        {% for analysis in token_analysis %}
        <div class="token-analysis">
            <div class="analysis-header">
                <strong>Sample Response {{ loop.index }}</strong>
                <span class="token-count">~{{ analysis.estimated_tokens }} tokens</span>
            </div>
            <div class="code-block">{{ analysis.json_str }}</div>
        </div>
        {% endfor %}
    </div>
    
    <div style="margin-top: 25px; padding: 20px; background: #f0fff4; border-radius: 10px; border-left: 4px solid #38a169;">
        <h3 style="color: #2d5016; margin-bottom: 10px;">üí° Efficiency Achievement</h3>
        <p style="color: #2d5016;">
            Average response size: <strong>~50 tokens</strong> vs standard systems (~200 tokens) = 
            <strong style="color: #38a169;">75% reduction</strong>
        </p>
    </div>
</div>
{% endif %}

<div class="card">
    <h2 style="margin-bottom: 20px; color: #2d3748;">üîß Implementation Details</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px;">
        <div class="impl-card">
            <h4>Core Components</h4>
            <ul style="margin: 10px 0; color: #666;">
                <li>ticket_ai.py - AI processing engine</li>
                <li>schemas.py - Data structures</li>
                <li>templates.py - Response templates</li>
                <li>app.py - Web interface</li>
            </ul>
        </div>
        
        <div class="impl-card">
            <h4>Storage</h4>
            <ul style="margin: 10px 0; color: #666;">
                <li>Simple JSON file storage</li>
                <li>No database dependencies</li>
                <li>Easy backup and migration</li>
                <li>Human-readable format</li>
            </ul>
        </div>
        
        <div class="impl-card">
            <h4>Auto-Classification</h4>
            <ul style="margin: 10px 0; color: #666;">
                <li>Keyword-based detection</li>
                <li>Priority from urgency words</li>
                <li>Category from context</li>
                <li>Fallback to defaults</li>
            </ul>
        </div>
        
        <div class="impl-card">
            <h4>Scalability</h4>
            <ul style="margin: 10px 0; color: #666;">
                <li>In-memory caching</li>
                <li>Pagination support</li>
                <li>Delta updates only</li>
                <li>Easy DB upgrade path</li>
            </ul>
        </div>
    </div>
</div>

<div class="card">
    <h2 style="margin-bottom: 20px; color: #2d3748;">üéØ Use Cases</h2>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 25px;">
        <div class="use-case-card">
            <h3>üë®‚Äçüíª Engineering Teams</h3>
            <ul style="margin: 15px 0; color: #666; line-height: 1.8;">
                <li>Bug tracking and resolution</li>
                <li>Code review requests</li>
                <li>Infrastructure issues</li>
                <li>Deployment problems</li>
                <li>Technical debt tracking</li>
            </ul>
        </div>
        
        <div class="use-case-card">
            <h3>üè¢ Consulting Companies</h3>
            <ul style="margin: 15px 0; color: #666; line-height: 1.8;">
                <li>Client request management</li>
                <li>Project issue tracking</li>
                <li>Documentation requests</li>
                <li>Meeting scheduling</li>
                <li>Resource allocation</li>
            </ul>
        </div>
    </div>
</div>

<div class="card">
    <h2 style="margin-bottom: 20px; color: #2d3748;">üöÄ Deployment Ready</h2>
    <div style="background: #f7fafc; padding: 20px; border-radius: 10px;">
        <h3 style="color: #2d3748; margin-bottom: 15px;">Integration Options</h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div class="integration-option">
                <h4 style="color: #4299e1;">ü§ñ ChatGPT</h4>
                <p style="color: #666; font-size: 0.9rem;">Use system prompt for direct integration</p>
            </div>
            <div class="integration-option">
                <h4 style="color: #48bb78;">üåê REST API</h4>
                <p style="color: #666; font-size: 0.9rem;">Extend with Flask endpoints</p>
            </div>
            <div class="integration-option">
                <h4 style="color: #ed8936;">üíæ Database</h4>
                <p style="color: #666; font-size: 0.9rem;">Upgrade to PostgreSQL/MongoDB</p>
            </div>
            <div class="integration-option">
                <h4 style="color: #9f7aea;">üîó Webhook</h4>
                <p style="color: #666; font-size: 0.9rem;">Connect to external systems</p>
            </div>
        </div>
    </div>
</div>

<style>
.arch-card, .use-case-card {
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    padding: 20px;
    border-radius: 12px;
    border-left: 4px solid #4299e1;
}

.arch-card h3, .use-case-card h3 {
    color: #2d3748;
    margin-bottom: 15px;
    font-size: 1.1rem;
}

.impl-card {
    background: #f7fafc;
    padding: 15px;
    border-radius: 8px;
    border: 1px solid #e2e8f0;
}

.impl-card h4 {
    color: #2d3748;
    margin-bottom: 8px;
}

.impl-card ul {
    list-style: none;
    padding: 0;
}

.impl-card li {
    padding: 3px 0;
    font-size: 0.9rem;
}

.impl-card li:before {
    content: "‚Ä¢ ";
    color: #4299e1;
    font-weight: bold;
}

.code-block {
    background: #2d3748;
    color: #e2e8f0;
    padding: 15px;
    border-radius: 6px;
    font-family: 'Monaco', 'Menlo', monospace;
    font-size: 0.85rem;
    overflow-x: auto;
    white-space: pre;
}

.token-analysis {
    background: #f8f9fa;
    border-radius: 10px;
    overflow: hidden;
    border: 1px solid #e9ecef;
}

.analysis-header {
    background: #4299e1;
    color: white;
    padding: 12px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.token-count {
    background: rgba(255, 255, 255, 0.2);
    padding: 4px 12px;
    border-radius: 15px;
    font-size: 0.85rem;
}

.integration-option {
    text-align: center;
    padding: 15px;
}

.integration-option h4 {
    margin-bottom: 8px;
}
</style>
{% endblock %}
